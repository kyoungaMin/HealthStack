# 2026-02-08 Devlog

## 1. AI Analysis Service Stability & Fallback Mechanism
- **Google Gemini API Issue**:
  - `google-generativeai` 라이브러리 및 모델(`gemini-1.5-flash`, `gemini-pro`) 호환성 문제로 `404 Not Found` 오류 빈번 발생.
  - 데이터 부족 시 AI Fallback 기능이 전체적으로 동작하지 않는 현상 확인.
- **OpenAI Fallback Strategy Implementation**:
  - `AnalyzeService` 클래스 내 `_analyze_with_ai` 메서드 개선.
  - 1차: Gemini 2.0 Flash 시도.
  - 2차(실패 시): OpenAI GPT-4o API 자동 호출 로직 추가.
  - **결과**: 기존 AI 호출 실패 케이스(14건) 모두 OpenAI Fallback을 통해 정상적으로 결과 생성 성공.

## 2. Drug Interaction Validation (Golden Question D6)
- **약물 상호작용 데이터 적재 이슈**:
  - `interaction_facts` 테이블의 `Check Constraint Violation`으로 테스트 데이터(Seed) 삽입 실패.
  - 원인 파악 불가(오류 메시지 잘림)했던 상황에서 `brute_force_seed.py` 스크립트를 작성하여 유효한 Enum 값 탐색.
  - **유효 값 확인**: `severity='high'`, `evidence_level='expert'`.
- **Seed Data Update**:
  - `docs/test/seed_interactions.py` 수정 및 실행 성공.
  - `Amlodipine + 메밀` (Buckwheat) 상호작용 데이터 적재 완료.
- **Verification**:
  - `verify_golden_questions.py` 실행 결과 D6 항목 정상 통과 (주의사항 출력 확인).

## 3. Creating Final Analysis Report (Golden Questions)
- **Docs Update**: `docs/test/analysis_golden_questions_v3.md` 생성.
- **Test Result**: **30/30 Pass (100%)**.
  - **Similarity/DB Match**: 16건 (53.3%)
  - **AI Generated (OpenAI/Gemini)**: 14건 (46.7%)
  - **Interaction Check**: 1건 (D6 - Successfully Validated)

## 4. Next Steps
- **Production Data Seeding**: `interaction_facts` 및 `foods_master`에 실제 임상 데이터 확충 필요.
- **Model Monitoring**: Gemini API 쿼터 및 안정성 모니터링 지속.
