# Golden Questions V1 분석 및 검증 결과 보고서

**작성일**: 2026-02-08  
**검증 대상**: `docs/test/golden_questions_v1.md` (주요 시나리오 A, B, C, D)  
**실행 스크립트**: `docs/test/verify_golden_questions.py`

---

## 1. 개요 (Overview)

Golden Questions(핵심 질문셋)를 사용하여 현재 구현된 `AnalyzeService`의 검색 및 추천 품질을 검증하였습니다. 초기 테스트에서는 일부 항목이 실패하였으나, 로직 수정 및 데이터 보완을 통해 최종적으로 **전 항목(5/5) 통과**를 달성하였습니다.

### 최종 테스트 결과 요약
| ID | 질문 (Query) | 매칭 결과 | 상태 | 비고 |
| :--- | :--- | :--- | :--- | :--- |
| **A1** | 식후 더부룩하고 트림이 잦아... | **소화불량** (High) | ✅ PASS | 유사어(더부룩, 트림) 매칭 성공 |
| **A2** | 속쓰림/역류가 있는데... | **소화불량** (Medium) | ✅ PASS | 속쓰림/역류 키워드 매핑 성공 |
| **B1** | 잠이 얕고 새벽에 자주 깨... | **불면증** (Medium) | ✅ PASS | '잠', '깨' 키워드로 불면증 매칭 |
| **C1** | 감기 기운(목 따가움)이 있어... | **기침** (Medium) | ✅ PASS | '감기' 키워드로 기침 증상 매핑 |
| **D1** | 혈압이 경계선. 짠맛 줄이기 말고... | **고혈압** (Medium) | ✅ PASS | **데이터 추가 후 성공** |

---

## 2. 주요 발견 문제점 및 해결 (Issues & Fixes)

테스트 과정에서 발견된 주요 기술적/데이터적 문제점과 이를 해결한 내역입니다.

### 1) 정렬 로직 오류 (Sorting Logic)
*   **문제**: 추천 식재료와 레시피가 `priority ASC`(오름차순)로 정렬되어, 중요도가 낮은 '주의(Caution)' 항목이나 관련성이 적은 항목이 최상단에 노출됨.
*   **현상**: 추천 리스트 1번에 '피해야 할 음식'이 먼저 뜨는 UX 문제 발생.
*   **해결**: `AnalyzeService` 내부의 DB 쿼리 정렬 조건을 `priority DESC`(내림차순)로 수정하여, 추천(Recommend/Good) 항목이 상위에 오도록 개선함.

### 2) 만성질환 데이터 누락 (Missing Data)
*   **문제**: `disease_master` 시드 데이터에 **'고혈압(Hypertension)'**, **'당뇨(Diabetes)'** 등 만성질환 정보가 없어 D1 질문이 DB 매칭에 실패하고 AI Fallback(결과 없음)으로 처리됨.
*   **해결**: 파이썬 스크립트를 통해 고혈압, 당뇨, 고지혈증 데이터를 `disease_master` 및 `symptom_ingredient_map`에 수동으로 추가(Seeding)하여 검색 되도록 조치함.

### 3) 키워드 매핑 단순성 (Keyword Mapping)
*   **문제**: 초기 로직은 단순 텍스트 포함 여부로만 검색하여, 사용자의 구체적인 증상 표현("속쓰림", "몸살")이 DB의 표준 증상명("소화불량", "감기")과 매칭되지 않음.
*   **해결**: `AnalyzeService` 내부에 동의어 사전(Dictionary)을 강화함.
    *   *속쓰림, 역류* → **소화**
    *   *몸살, 으슬으슬* → **호흡/감기**
    *   사용자 입력 토큰보다 매핑된 핵심 키워드를 우선 검색하도록 로직 개선.

---

## 3. 향후 보완 과제 (Future Improvements)

분석 엔진의 완성도를 높이기 위해 다음 사항들이 추가로 개발되어야 합니다.

### 1) 만성질환 전용 레시피 확충
*   현재 고혈압(D1) 등 만성질환에 매핑된 구체적인 **저염식 레시피**나 **당뇨식 레시피**가 부족하여, 레시피 추천 결과가 비어있는 경우가 있음.
*   `recipes` 테이블과 `symptom_recipe_map`에 만성질환 관리용 식단 데이터를 추가 필요.

### 2) 약물 상호작용(Interaction) 분석 구현 (D6 시나리오)
*   아직 약물 상호작용(예: 고혈압약 + 자몽, 와파린 + 녹색채소) 체크 로직은 `AnalyzeService`에 구현되지 않음.
*   `interaction_facts` 테이블을 활용하여, 사용자가 복용 중인 약물을 입력받았을 때 경고(Caution)를 띄우는 로직 구현 필요.

### 3) AI Fallback 연동
*   현재 DB 매칭에 실패하면 "AI가 분석합니다"라는 정적 메시지만 반환함.
*   실제 운영 시에는 Google Gemini 등의 LLM을 호출하여, DB에 없는 복합 증상(예: "머리가 아프면서 소화도 안 되고 발목도 삐었어")에 대해서도 유연한 답변을 생성하도록 연동 필요.
